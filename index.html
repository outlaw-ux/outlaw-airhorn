<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width" />

    <link rel="manifest" href="manifest.json" />

    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="Airhorn" />
    <meta name="apple-mobile-web-app-title" content="Airhorn" />
    <meta name="theme-color" content="#4c6085" />
    <meta name="msapplication-navbutton-color" content="#4c6085" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="msapplication-starturl" content="/" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <link rel="icon" type="image/svg+xml" sizes="192x192" href="airhorn.svg" />
    <link
      rel="apple-touch-icon"
      type="image/svg+xml"
      sizes="192x192"
      href="airhorn.svg"
    />

    <title>Outlaw Airhorn</title>

    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <style>
      * {
        margin: 0;
        padding: 0;
      }
      *,
      *:before,
      *:after {
        box-sizing: border-box;
      }

      html,
      body {
        height: 100vh;
      }

      body {
        display: flex;
        flex-direction: column-reverse;
        align-items: center;
        justify-content: flex-start;
        height: 100vh;
        overflow: hidden;
        background-color: #32322c;
        font-family: Droid Sans, Helvetica Neue, "CMU Sans Serif",
          "Liberation Sans", FreeSans, "DejaVu Sans", "Helvetica CY",
          "Helvetica CE", "Lucida Grande", "Segoe UI", Tahoma,
          "Lucida Sans Unicode", "Doulos SIL", "TITUS Cyberbit Basic",
          "Last Resort", "Arial Unicode MS", Helvetica, sans-serif;
      }

      .play {
        border: 0;
        background: none;
        cursor: pointer;
        flex: 1;
      }

      .play svg {
        transition: fill 150ms ease-in-out;
        fill: #4c6085;
        width: 50vw;
      }

      .play svg:hover {
        fill: #bfd7ea;
      }

      footer {
        justify-content: space-around;
        font-size: 10px;
      }

      .copy {
        color: #ff6663;
        display: flex;
        flex-direction: column;
        text-align: center;
      }

      footer a {
        color: #ff6663;
      }
    </style>
  </head>

  <body>
    <button class="play">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1336 1675">
        <path
          d="M1085.199 332.692C921.543 157.11 742.282 61.216 672.418 74.109c-26.358 4.864-48.078 15.089-55.412 43.529-15.118 58.632 39.641 156.954 72.231 207.613 150.534 233.994 427.27 432.28 540.731 414.184 111.583-17.798 27.405-222.023-144.769-406.743zm-186.266 27.726c-11.318 8.651-20.05 21.712-29.836 32.035-39.259 41.415-39.226 39.772-48.573 28.847-55.098-64.925-158.284-193.386-158.526-279.89-.095-34.173 41.933-20.111 61.49-12.068 50.789 20.887 89.506 35.064 145.134 74.242 87.128 61.365 301.059 258.27 353.604 413.152 6.227 18.354 23.452 58.506 4.717 73.59-11.067 8.91-23.624 3.118-35.397-.339-42.604-12.507-85.037-28.607-142.542-64.689-10.915-6.849-127.474-93.906-122.392-98.824 23.665-22.9 46.199-46.972 69.967-69.757 37.129-35.58-46.673-135.26-97.646-96.299zM800.104 1377.102c-13.529 12.697-60.909 60.275-60.913 60.278.032.433.076.898.134 1.375a14.72 14.72 0 0 0-1.356-.14c-3.305 3.815-7.241 7.03-10.565 10.832-.102.299-.299.904-.401 1.204-2.31.337-10.114 9.753-13.927 12.838.032.433.076.891.14 1.375-.471-.07-.923-.121-1.363-.146-1.705 2.182-11.763 11.794-12.768 12.774.038.51.083 1.038.14 1.586a33.23 33.23 0 0 0-1.134-.974c-1.73 2.241-9.747 5.998-12.399 5.763l-.153 1.891c-.427-1.477-2.878-1.987-3.401-.357-2.136-1.082-10.76-.08-17.863-4.623-8.696-6.003 7.475 8.617-31.681-30.089-9.096-9.991-11.047-25.649.866-42.1 2.695-.814.421-.436 61.116-61.088 51.02-50.984 61.472-74.08 104.72-24.873 8.816 10.029 28.047 28.912.808 54.474z"
        />
        <path
          d="M785.278 1402.827c-53.8 117.162-24.614 75.601-129.327 171.573-76.61 70.215-65.636 54.682-88.392 98.364-346.014 0-338.115-.076-338.115-.076.156-.082 81.262-138.856 81.35-139.007 31.144-53.32 26.99-36.202 16.801-75.464-37.104-163.291-50.649-120.445-20.461-171.442 4.569-8.332 76.505-133.547 77.498-134.548 3.86-3.89 84.009-27.689 85.01-27.272 1.579.783 2.312 2.515 3.458 3.789 29.066 32.137 109.578 75.674 109.578 75.674 47.848 26.915 54.773 19.209 51.662 26.083-16.886 37.3-94.172 47.2-112.288 50.32-22.016 3.79-20.511-1.839-79.614-34.592-7.716 12.841-20.868 35.88-22.435 38.686 5.78 2.4 19.286 11.757 20.766 12.405.938 1 39.532 28.148 60.032 59.707 7.659 7.7 32.745 54.965 35.973 72.367l5.145 21.416c11.164 62.937-7.298 117.562-15.436 128.438-1.248 5.801-6.228 9.928-7.788 15.583a44.77 44.77 0 0 1 4.241 2.051c2.56-4.757 5.228-9.482 8.196-13.991-.089-.669-.306-1.388.178-1.923 2.056-3.33 7.07-16.125 7.419-16.576-.07-.662-.216-1.356.242-1.879 2.641-4.024 7.93-27.66 8.17-28.663.107-7.172 8.113-27.164-.115-84.951-15.665-70.174-46.483-98.248-50.878-106.833 9.787 4.327 11.612 18.932 43.632 11.193-.426 4.755-13.734 16.373 16.768 49.704 11.165 12.201 29.936 27.879 47.45 24.483 1.135-.22 13.692-3.765 13.758-2.644 1.618 27.185 8.395 32.019 35.954 57.588 7.923 7.351 20.03 10.51 30.617 9.296 29.295-3.358 67.058-62.485 100.951-88.859z"
        />
        <path
          d="M764.507 1264.215c-5.057 16.608-75.507 73.598-138.19 143.528-15.641 17.45-40.127 16.851-53.714-.683-10.559-11.792-26.478-21.628-27.951-41.2 3.435-17.685-.616-11.061 39.015-51.186.988-1 94.988-97.496 108.107-107.815 13.071-10.281 31.769-8.321 43.602 3.426 19.483 19.341 36.49 29.762 29.131 53.93zM687.03 1201.137s2.217-2.75-51.371 50.816c-94.934 94.955-90.635 94.395-107.449 96.56-10.483-1.033-17.122-2.202-29.637-15.143-24.796-25.662-24.936-21.743-25.848-36.979-.555-9.035 1.68-14.963 7.005-23.053-.261.395 16.525 9.794 18.238 10.52 18.23 7.782 89.783-2.884 128.245-34.505 6.677-5.49 8.469-8.78 13.974-18.618.961-1.433.694-3.248 1.114-4.84-4.133-6.541-11.155-3.068-23.078-9.756-17.816-7.037-35.129-17.111-50.254-25.469-3.711-2.051-3.064-1.701 4.453-9.844 50.106-49.662 48.203-48.527 53.322-50.53 23.211-9.08 34.162 4.751 40.639 11.226 16.568 16.564 25.589 23.112 27.013 36.974.806 7.853-1.205 16.58-6.366 22.641zM616.255 1126.495c-2.277 4.809-58.631 58.858-56.642 57.768-2.383 1.305-49.052-29.112-73.868-50.107-4.22-3.569-7.46-3.425-.482-10.115 63.173-60.564 65.348-74.811 90.626-67.85 10.54 2.902 17.455 12.697 25.052 19.949 4.658 4.447 9.954 8.721 13.849 13.882 8.13 10.434 9.023 25.26 1.465 36.473zM566.966 998.91c-135.553 135.378-115.235 117.985-130.532 122.709-69.686 21.519-55.362 8.974-86.2 66.406-41.092 76.528-46.245 73.861-73.689 101.285-53.2 53.16-251.384-150.871-217.289-204.531 1.445-3.169 296.336-297.277 297.34-298.276.236-.064.707-.197.949-.261 1.55 1.139 187.347 187.11 189.197 188.961 21.541 21.52 22.813 21.675 20.224 23.707zM473.049 1269.86c-1.651 2.147-13.728 9.892-29.582 4.233-12.543-4.478-8.561-3.605.187-20.503 2.342-.032 28.389 15.475 29.395 16.27zM469.878 1313.908c-.192-.896-23.891-19.123-26.01-20.532-1.129-.751-2.918-1.289-3.844-2.266-3.764-3.998-12.088-6.364-12.601-8.804-.492-2.347 2.417-4.567 3.626-6.236 1.058 2.168 14.287 6.594 15.861 6.924 14.344 3.001 17.703-.844 19.809-1.461-.817.239-3.459 12.999-.134 23.815.896 2.915 2.655 5.594 3.293 8.56zM476.832 1274.948c.079.079.224.216.287.274M757.914 1275.782s-.102-.089-.293-.274M475.857 1277.757s-.102-.089-.293-.274M472.648 1314.717s-.096-.089-.287-.274M646.107 261.923c84.753 168.002 302.227 390.127 488.154 465.141-47.483 4.385-303.85-16.814-553.29 217.595-4.684 4.402-29.567 30.32-31.53 27.517-56.154-56.23-112.423-112.346-168.532-168.615.998 1.001 94.646-98.058 153.699-208.423 56.342-105.298 90.57-228.552 90.473-355.736 0-4.534-.26-9.148-.01-13.675.789-14.252 6.661 7.701 21.036 36.196zM567.558 1672.764H231.315"
        />
      </svg>
    </button>

    <footer>
      <p class="copy">
        <a
          href="https://github.com/outlaw-ux/outlaw-airhorn"
          target="_blank"
          rel="noopener noreferrer"
          >Made with &hearts; by OutlawUX</a
        >
      </p>
    </footer>
  </body>
  <script>
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const offlineCtx = new OfflineAudioContext(2, 44100 * 40, 44100);
    const play = document.querySelector(".play");

    source = offlineCtx.createBufferSource();

    if (audioCtx) {
      unlockAudioContext(audioCtx);
      getData(audioCtx);
    }

    if (offlineCtx) {
      offlineCtx.oncomplete = function(e) {
        const audioCtx = new (window.AudioContext ||
          window.webkitAudioContext)();
        const horn = audioCtx.createBufferSource();
        horn.buffer = e.renderedBuffer;

        horn.connect(audioCtx.destination);

        play.onclick = function() {
          horn.start();
        };
      };
    }

    function getData(audioCtx) {
      request = new XMLHttpRequest();
      request.open("GET", "airhorn.mp3", true);
      request.responseType = "arraybuffer";

      request.onload = function() {
        const audioData = request.response;

        audioCtx.decodeAudioData(
          audioData,
          function(buffer) {
            myBuffer = buffer;
            source.buffer = myBuffer;
            source.connect(offlineCtx.destination);
            source.start();
            offlineCtx.startRendering();
          },

          function(e) {
            `Error with decoding audio data ${e.err}`;
          }
        );
      };

      request.send();
    }

    function unlockAudioContext(audioCtx) {
      if (audioCtx.state !== "suspended") return;
      const b = document.body;
      const events = ["touchstart", "touchend", "mousedown", "keydown"];
      events.forEach(e => b.addEventListener(e, unlock, false));
      function unlock() {
        audioCtx.resume().then(clean);
      }
      function clean() {
        events.forEach(e => b.removeEventListener(e, unlock));
      }
    }
  </script>
</html>
